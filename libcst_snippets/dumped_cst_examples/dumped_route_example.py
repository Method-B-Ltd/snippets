from libcst import (
    Module, SimpleStatementLine, ImportFrom, Name, ImportAlias, Assign, AssignTarget, SimpleString, Call, Arg,
    FunctionDef, Parameters, IndentedBlock, Decorator, Attribute, Expr, List, Element, Param, If,
    Ellipsis)

Module(
    body=[
        SimpleStatementLine(
            body=[
                ImportFrom(
                    module=Name(
                        value='flask',
                    ),
                    names=[
                        ImportAlias(
                            name=Name(
                                value='Flask',
                            ),
                        ),
                        ImportAlias(
                            name=Name(
                                value='Blueprint',
                            ),
                        ),
                        ImportAlias(
                            name=Name(
                                value='g',
                            ),
                        ),
                    ],
                ),
            ],
        ),
        SimpleStatementLine(
            body=[
                Assign(
                    targets=[
                        AssignTarget(
                            target=Name(
                                value='BUY_PERMISSION',
                            ),
                        ),
                    ],
                    value=SimpleString(
                        value='"buy"',
                    ),
                ),
            ],
        ),
        SimpleStatementLine(
            body=[
                Assign(
                    targets=[
                        AssignTarget(
                            target=Name(
                                value='ADMIN_PERMISSION',
                            ),
                        ),
                    ],
                    value=SimpleString(
                        value='"admin"',
                    ),
                ),
            ],
        ),
        SimpleStatementLine(
            body=[
                Assign(
                    targets=[
                        AssignTarget(
                            target=Name(
                                value='app',
                            ),
                        ),
                    ],
                    value=Call(
                        func=Name(
                            value='Flask',
                        ),
                        args=[
                            Arg(
                                value=Name(
                                    value='__name__',
                                ),
                            ),
                        ],
                    ),
                ),
            ],
        ),
        FunctionDef(
            name=Name(
                value='menu',
            ),
            params=Parameters(),
            body=IndentedBlock(
                body=[
                    SimpleStatementLine(
                        body=[
                            Expr(
                                value=Ellipsis(),
                            ),
                        ],
                    ),
                ],
            ),
            decorators=[
                Decorator(
                    decorator=Call(
                        func=Attribute(
                            value=Name(
                                value='app',
                            ),
                            attr=Name(
                                value='route',
                            ),
                        ),
                        args=[
                            Arg(
                                value=SimpleString(
                                    value='"/menu"',
                                ),
                            ),
                        ],
                    ),
                ),
            ],
        ),
        FunctionDef(
            name=Name(
                value='buy',
            ),
            params=Parameters(),
            body=IndentedBlock(
                body=[
                    SimpleStatementLine(
                        body=[
                            Expr(
                                value=Call(
                                    func=Attribute(
                                        value=Attribute(
                                            value=Name(
                                                value='g',
                                            ),
                                            attr=Name(
                                                value='user',
                                            ),
                                        ),
                                        attr=Name(
                                            value='require',
                                        ),
                                    ),
                                    args=[
                                        Arg(
                                            value=Name(
                                                value='BUY_PERMISSION',
                                            ),
                                        ),
                                    ],
                                ),
                            ),
                        ],
                    ),
                ],
            ),
            decorators=[
                Decorator(
                    decorator=Call(
                        func=Attribute(
                            value=Name(
                                value='app',
                            ),
                            attr=Name(
                                value='route',
                            ),
                        ),
                        args=[
                            Arg(
                                value=SimpleString(
                                    value='"/buy"',
                                ),
                            ),
                            Arg(
                                value=List(
                                    elements=[
                                        Element(
                                            value=SimpleString(
                                                value='"GET"',
                                            ),
                                        ),
                                        Element(
                                            value=SimpleString(
                                                value='"POST"',
                                            ),
                                        ),
                                    ],
                                ),
                                keyword=Name(
                                    value='methods',
                                ),
                            ),
                        ],
                    ),
                ),
            ],
        ),
        FunctionDef(
            name=Name(
                value='item',
            ),
            params=Parameters(
                params=[
                    Param(
                        name=Name(
                            value='item_id',
                        ),
                        star='',
                    ),
                ],
            ),
            body=IndentedBlock(
                body=[
                    SimpleStatementLine(
                        body=[
                            Assign(
                                targets=[
                                    AssignTarget(
                                        target=Name(
                                            value='item',
                                        ),
                                    ),
                                ],
                                value=Call(
                                    func=Name(
                                        value='get_item',
                                    ),
                                    args=[
                                        Arg(
                                            value=Name(
                                                value='item_id',
                                            ),
                                        ),
                                    ],
                                ),
                            ),
                        ],
                    ),
                    If(
                        test=Attribute(
                            value=Name(
                                value='item',
                            ),
                            attr=Name(
                                value='archived',
                            ),
                        ),
                        body=IndentedBlock(
                            body=[
                                SimpleStatementLine(
                                    body=[
                                        Expr(
                                            value=Call(
                                                func=Attribute(
                                                    value=Attribute(
                                                        value=Name(
                                                            value='g',
                                                        ),
                                                        attr=Name(
                                                            value='user',
                                                        ),
                                                    ),
                                                    attr=Name(
                                                        value='require',
                                                    ),
                                                ),
                                                args=[
                                                    Arg(
                                                        value=Name(
                                                            value='ADMIN_PERMISSION',
                                                        ),
                                                    ),
                                                ],
                                            ),
                                        ),
                                    ],
                                ),
                            ],
                        ),
                    ),
                    SimpleStatementLine(
                        body=[
                            Expr(
                                value=Ellipsis(),
                            ),
                        ],
                    ),
                ],
            ),
            decorators=[
                Decorator(
                    decorator=Call(
                        func=Attribute(
                            value=Name(
                                value='app',
                            ),
                            attr=Name(
                                value='route',
                            ),
                        ),
                        args=[
                            Arg(
                                value=SimpleString(
                                    value='"/items/<item_id>"',
                                ),
                            ),
                        ],
                    ),
                ),
            ],
        ),
        SimpleStatementLine(
            body=[
                Assign(
                    targets=[
                        AssignTarget(
                            target=Name(
                                value='admin',
                            ),
                        ),
                    ],
                    value=Call(
                        func=Name(
                            value='Blueprint',
                        ),
                        args=[
                            Arg(
                                value=SimpleString(
                                    value='"admin"',
                                ),
                            ),
                            Arg(
                                value=Name(
                                    value='__name__',
                                ),
                            ),
                            Arg(
                                value=SimpleString(
                                    value='"/admin"',
                                ),
                                keyword=Name(
                                    value='url_prefix',
                                ),
                            ),
                        ],
                    ),
                ),
            ],
        ),
        FunctionDef(
            name=Name(
                value='users',
            ),
            params=Parameters(),
            body=IndentedBlock(
                body=[
                    SimpleStatementLine(
                        body=[
                            Expr(
                                value=Call(
                                    func=Attribute(
                                        value=Attribute(
                                            value=Name(
                                                value='g',
                                            ),
                                            attr=Name(
                                                value='user',
                                            ),
                                        ),
                                        attr=Name(
                                            value='require',
                                        ),
                                    ),
                                    args=[
                                        Arg(
                                            value=Name(
                                                value='ADMIN_PERMISSION',
                                            ),
                                        ),
                                    ],
                                ),
                            ),
                        ],
                    ),
                    SimpleStatementLine(
                        body=[
                            Expr(
                                value=Ellipsis(),
                            ),
                        ],
                    ),
                ],
            ),
            decorators=[
                Decorator(
                    decorator=Call(
                        func=Attribute(
                            value=Name(
                                value='admin',
                            ),
                            attr=Name(
                                value='route',
                            ),
                        ),
                        args=[
                            Arg(
                                value=SimpleString(
                                    value='"/users"',
                                ),
                            ),
                        ],
                    ),
                ),
            ],
        ),
    ],
)
